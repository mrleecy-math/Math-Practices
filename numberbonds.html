<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Number Bonds Racing Game</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f0f8ff;
    margin: 0;
    padding: 0;
  }
  h1 { font-size: 1.5em; margin: 10px 0; }
  .menu { margin-top: 40px; }
  button {
    font-size: 1.2em;
    padding: 10px 20px;
    margin: 10px;
    border-radius: 10px;
    border: none;
    background: #4CAF50;
    color: white;
    cursor: pointer;
  }
  button:hover { background: #45a049; }
  #gameArea { display: none; margin-top: 20px; }
  .bond {
    font-size: 1.5em;
    margin: 20px 0;
  }
  input {
    font-size: 1.2em;
    width: 60px;
    text-align: center;
    margin: 5px;
  }
  #message { margin: 15px; font-size: 1.2em; font-weight: bold; }
  #streak { margin: 10px; font-size: 1.2em; }
  #track {
    position: relative;
    height: 80px;
    width: 90%;
    max-width: 700px;
    margin: 20px auto;
    border: 3px solid #333;
    border-radius: 15px;
    background: linear-gradient(to right, #ddd, #fff);
  }
  #car {
    position: absolute;
    top: 20px;
    left: 0;
    width: 60px;
    height: 40px;
    background: url('https://i.imgur.com/H6K7QZT.png') no-repeat center;
    background-size: contain;
    transition: left 0.5s ease;
  }
  #finish {
    position: absolute;
    top: 5px;
    right: -15px;
    width: 50px;
    height: 70px;
    background: url('https://i.imgur.com/FdYH0T4.png') no-repeat center;
    background-size: contain;
  }
  #countdown { font-size: 1.3em; margin: 10px; }
  #restartBtn {
    display: none;
    margin-top: 20px;
    background: #2196F3;
  }
</style>
</head>
<body>

<h1>Number Bonds Racing Game ðŸš—</h1>

<div class="menu" id="menu">
  <p>Select Max Sum:</p>
  <button onclick="setSum(10)">Up to 10</button>
  <button onclick="setSum(20)">Up to 20</button>
</div>

<div class="menu" id="modeMenu" style="display:none;">
  <p>Select Mode:</p>
  <button onclick="startGame('normal')">Normal</button>
  <button onclick="startGame('challenge')">Challenge</button>
</div>

<div id="gameArea">
  <div id="countdown">20 steps to finish</div>
  <div class="bond" id="bondDisplay"></div>
  <input type="number" id="inputA" placeholder="?" />
  <input type="number" id="inputB" placeholder="?" />
  <input type="number" id="inputC" placeholder="?" />
  <br>
  <button onclick="checkAnswer()">Check</button>
  <button id="nextBtn" onclick="nextQuestion()" disabled>Next</button>
  <div id="message"></div>
  <div id="streak">Streak: 0</div>

  <div id="track">
    <div id="car"></div>
    <div id="finish"></div>
  </div>
  <button id="restartBtn" onclick="restartGame()">Restart Game</button>
</div>

<script>
let maxSum = 10;
let mode = "normal";
let currentA, currentB, currentC;
let blanks = [];
let attempted = false;
let streak = 0;
let carPosition = 0;
let totalSteps = 20;
let stepsRemaining = 20;

// sounds
const correctSound = new Audio("https://www.soundjay.com/buttons/sounds/button-3.mp3");
const wrongSound = new Audio("https://www.soundjay.com/buttons/sounds/button-10.mp3");
const cheerSound = new Audio("https://www.soundjay.com/human/sounds/applause-8.mp3");

function setSum(sum) {
  maxSum = sum;
  document.getElementById("menu").style.display = "none";
  document.getElementById("modeMenu").style.display = "block";
}

function startGame(selectedMode) {
  mode = selectedMode;
  document.getElementById("modeMenu").style.display = "none";
  document.getElementById("gameArea").style.display = "block";
  streak = 0;
  carPosition = 0;
  stepsRemaining = totalSteps;
  updateCountdown();
  document.getElementById("car").style.left = "0px";
  nextQuestion();
}

function nextQuestion() {
  document.getElementById("message").textContent = "";
  document.getElementById("nextBtn").disabled = true;
  attempted = false;
  generateQuestion();
}

function generateQuestion() {
  let sum;
  if (maxSum === 10) {
    sum = Math.floor(Math.random() * 10) + 1;
  } else {
    sum = Math.floor(Math.random() * 10) + 11; // 11â€“20
  }
  let part = Math.floor(Math.random() * (sum + 1));
  currentA = sum;
  currentB = part;
  currentC = sum - part;

  blanks = [];
  document.getElementById("inputA").value = "";
  document.getElementById("inputB").value = "";
  document.getElementById("inputC").value = "";

  let blankCount = Math.random() < 0.5 ? 1 : 2;
  if (blankCount === 1) {
    let choice = ["A","B","C"][Math.floor(Math.random()*3)];
    blanks.push(choice);
  } else {
    blanks = ["B","C"];
  }

  if (!blanks.includes("A")) document.getElementById("inputA").value = currentA;
  if (!blanks.includes("B")) document.getElementById("inputB").value = currentB;
  if (!blanks.includes("C")) document.getElementById("inputC").value = currentC;

  document.getElementById("bondDisplay").textContent = 
    `Number bond: ${currentA} = ${currentB} + ${currentC}`;
}

function checkAnswer() {
  if (attempted) return;
  attempted = true;

  let valA = document.getElementById("inputA").value;
  let valB = document.getElementById("inputB").value;
  let valC = document.getElementById("inputC").value;

  if (valA === "" || valB === "" || valC === "") {
    document.getElementById("message").textContent = "Fill in all blanks!";
    attempted = false;
    return;
  }

  valA = parseInt(valA);
  valB = parseInt(valB);
  valC = parseInt(valC);

  if (valA < 1 || valB < 0 || valC < 0) {
    document.getElementById("message").textContent = "Only whole numbers >0 for total!";
    attempted = false;
    return;
  }

  if (valB + valC === valA) {
    correctSound.play();
    document.getElementById("message").textContent = "Correct!";
    streak++;
    document.getElementById("streak").textContent = "Streak: " + streak;
    moveCar();
  } else {
    wrongSound.play();
    document.getElementById("message").textContent = "Try again!";
    streak = 0;
    document.getElementById("streak").textContent = "Streak: 0";
    if (mode === "challenge") {
      carPosition = 0;
      stepsRemaining = totalSteps;
      updateCountdown();
      document.getElementById("car").style.left = "0px";
    }
  }

  document.getElementById("nextBtn").disabled = false;
}

function moveCar() {
  carPosition++;
  stepsRemaining = totalSteps - carPosition;
  updateCountdown();
  let trackWidth = document.getElementById("track").offsetWidth - 70;
  let stepSize = trackWidth / totalSteps;
  let newLeft = carPosition * stepSize;
  document.getElementById("car").style.left = newLeft + "px";

  if (carPosition >= totalSteps) {
    cheerSound.play();
    document.getElementById("message").textContent = "ðŸŽ‰ Congratulations! You reached the finish line!";
    document.getElementById("nextBtn").disabled = true;
    document.getElementById("restartBtn").style.display = "inline-block";
  }
}

function updateCountdown() {
  document.getElementById("countdown").textContent = stepsRemaining + " steps to finish";
}

function restartGame() {
  document.getElementById("restartBtn").style.display = "none";
  document.getElementById("message").textContent = "";
  startGame(mode);
}
</script>

</body>
</html>
